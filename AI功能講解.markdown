# 用戶系統網站AI功能講解

以下為用戶系統網站的AI功能介紹、運作原理以及操作說明，旨在為演講提供清晰的中文內容，幫助聽眾理解網站的AI功能及其使用方式。

## 1. AI搜尋文件內容

### 功能介紹
AI搜尋文件內容功能允許用戶輸入關鍵詞，通過AI技術快速查找與輸入查詢相關的文本或PDF文件。該功能基於自然語言處理技術，能夠理解查詢的語義，並返回與用戶查詢內容最相關的文件。

### 運作原理
- **技術基礎**：使用 `sentence-transformers` 模型（`all-MiniLM-L6-v2`）進行語義嵌入（embedding）。
- **流程**：
  1. 用戶在前端輸入搜尋詞（例如「cat」）。
  2. 前端通過 `aiSearchForm` 表單提交查詢到後端 `/api/ai_search` 端點。
  3. 後端使用 `SentenceTransformer` 模型將查詢文本轉換為語義嵌入向量。
  4. 從資料庫中檢索用戶有權訪問的文件（包括自己上傳的、共享給用戶的或公開共享的文件）。
  5. 比較查詢嵌入向量與文件嵌入向量的餘弦相似度（cosine similarity），篩選相似度高於0.1的文件。
  6. 將結果按相似度排序並返回前端，顯示文件名、擁有者、共享狀態等信息。
- **資料庫支持**：文件內容和嵌入向量儲存在 SQLite 資料庫的 `files` 表中，嵌入向量以二進制形式保存。

### 操作說明
1. 登錄後，導航至儀表板（`dashboard.html`）。
2. 在「AI搜尋文件內容」區塊，輸入搜尋詞（例如「旅遊計劃」）。
3. 點擊「AI搜尋」按鈕。
4. 搜尋結果將顯示在下方，包括文件名、擁有者、共享狀態及相似度百分比。
5. 點擊結果中的「下載」鏈接可下載相應文件。

## 2. AI推薦相似文件

### 功能介紹
此功能根據用戶選擇的某個文件，推薦與其內容相似的其他文件，幫助用戶發現相關資料，提升文件管理的效率。

### 運作原理
- **技術基礎**：同樣使用 `sentence-transformers` 模型進行語義嵌入比較。
- **流程**：
  1. 用戶在「已上傳文件」或「文件夾內容」區塊點擊文件的「AI推薦相似文件」按鈕。
  2. 前端發送請求到後端 `/api/recommend/<file_id>` 端點，帶上文件ID。
  3. 後端從資料庫中檢索指定文件的嵌入向量。
  4. 比較該嵌入向量與用戶有權訪問的其他文件嵌入向量的餘弦相似度。
  5. 篩選相似度高於0.1的文件，按相似度排序，返回最多5個結果。
  6. 前端在「AI推薦文件(指定文件)」區塊顯示推薦結果。
- **資料庫支持**：與AI搜尋功能相同，依賴 `files` 表的嵌入向量。

### 操作說明
1. 在儀表板（`dashboard.html`）或文件夾內容頁（`folder_files.html`）的「已上傳文件」區塊，找到目標文件。
2. 點擊文件的「AI推薦相似文件」按鈕。
3. 推薦結果將顯示在「AI推薦文件(指定文件)」區塊，包含文件名、擁有者等信息。
4. 可點擊「下載」鏈接獲取推薦的文件。

## 3. AI推薦文件(上載文件)

### 功能介紹
此功能自動為用戶推薦基於其最近上傳文件的相似文件，無需用戶主動指定文件，方便快速發現相關內容。

### 運作原理
- **技術基礎**：使用 `sentence-transformers` 模型進行語義嵌入比較。
- **流程**：
  1. 用戶登錄後，儀表板自動觸發 `/api/recommend` 端點請求。
  2. 後端從資料庫中檢索用戶最近上傳的文件（按 `created_at` 排序）。
  3. 提取該文件的嵌入向量，與用戶有權訪問的其他文件進行餘弦相似度比較。
  4. 篩選相似度高於0.1的文件，按相似度排序，返回最多5個結果。
  5. 前端在「AI推薦文件(上載文件)」區塊顯示結果。
- **資料庫支持**：依賴 `files` 表的嵌入向量和 `created_at` 時間戳。

### 操作說明
1. 登錄後進入儀表板（`dashboard.html`）。
2. 「AI推薦文件(上載文件)」區塊將自動顯示基於最近上傳文件的推薦結果。
3. 查看推薦文件的詳細信息，如文件名、擁有者等。
4. 點擊「下載」鏈接可下載推薦文件。

## 總結
這些AI功能通過語義嵌入和餘弦相似度比較，為用戶提供智能化的文件搜尋和推薦體驗。用戶只需簡單操作即可快速找到相關文件，無需手動瀏覽大量資料。所有功能均依賴後端的 `sentence-transformers` 模型和 SQLite 資料庫，確保高效且安全的文件管理。
